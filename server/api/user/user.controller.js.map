{"version":3,"sources":["api/user/user.controller.js"],"names":["index","create","setHighScore","getHighScore","setScoreZero","contacts","spons","show","destroy","changePassword","me","authCallback","validationError","res","statusCode","err","status","json","handleError","send","respondWithResult","entity","req","find","exec","then","users","catch","body","rollNumber","split","join","toUpperCase","console","log","findOne","newUser","house","_id","provider","role","save","user","token","sign","secrets","session","expiresIn","next","score","highscore","sort","limit","update","$set","multi","title","num","isMongoId","params","id","userId","findById","end","profileDetails","findByIdAndRemove","oldPass","String","oldPassword","newPass","newPassword","authenticate","password","populate","redirect"],"mappings":"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","file":"api/user/user.controller.js","sourcesContent":["\"use strict\";\n\nimport User from \"./user.model\";\nimport House from \"../house/house.model\";\nimport validator from \"validator\";\nimport config from \"../../config/environment\";\nimport jwt from \"jsonwebtoken\";\n\nfunction validationError(res, statusCode) {\n  statusCode = statusCode || 422;\n  return function(err) {\n    return res.status(statusCode).json(err);\n  };\n}\n\nfunction handleError(res, statusCode) {\n  statusCode = statusCode || 500;\n  return function(err) {\n    return res.status(statusCode).send(err);\n  };\n}\n\nfunction respondWithResult(res, statusCode) {\n  statusCode = statusCode || 200;\n  return function(entity) {\n    if(entity) {\n      return res.status(statusCode).json(entity);\n    }\n    return null;\n  };\n}\n\n/**\n * Get list of users\n * restriction: \"admin\"\n */\nexport function index(req, res) {\n  return User.find({}, \"-salt -password\").exec()\n    .then(users => {\n      res.status(200).json(users);\n    })\n    .catch(handleError(res));\n}\n\n\n/**\n * Creates a new user\n */\nexport function create(req, res) {\n\n  if(req.body.rollNumber){\n    var rollNumber = req.body.rollNumber.split(\" \");\n    rollNumber = rollNumber.join(\"\").toUpperCase();\n    console.log(rollNumber,222222);\n    House.findOne({ \"team.member\": rollNumber})\n    .exec()\n    .then(house=>{\n\n      var newUser = new User(req.body);\n      console.log(house, 32333333333);\n\n      if(house)\n        newUser.house = house._id;\n\n      newUser.provider = \"local\";\n      newUser.role = \"user\";\n      newUser.save()\n        .then(function(user) {\n          var token = jwt.sign({ _id: user._id }, config.secrets.session, {\n            expiresIn: 60 * 60 * 5\n          });\n          res.json({ token });\n        })\n        .catch(validationError(res));\n    })\n  }\n  else\n    return res.send(400);\n}\n\nexport function setHighScore(req, res, next){\n  console.log(req.body.score);\n  if(req.user.highscore<req.body.score)\n    req.user.highscore = req.body.score;\n  req.user.save()\n  .then(respondWithResult(res))\n  .catch(handleError(res));\n}\n\nexport function getHighScore(req, res, next){\n  User.find({}, \"name highscore college\").sort({highscore:-1}).limit(3)\n  .then(respondWithResult(res))\n  .catch(handleError(res));  \n}\n\nexport function setScoreZero(req, res, next){\n  console.log(\"here\");\n  User.update({}, {$set:{highscore:0}}, {multi:true})\n  .then(respondWithResult(res))\n  .catch(handleError(res));\n}\n\nexport function contacts(req, res){\n  var contacts =  [\n      {\n        \"type\":\"Secretary\",\n        \"profile\":[{\"name\":\"M Vidyadhar\", \"email\":\"m.vidyadhar95@gmail.com\", \"phone\":\"9952044531\"},\n        {\"name\":\"S Chandra vadan\", \"email\":\"scvchandras@gmail.com\", \"phone\":\"7981487567\"}\n      ]},\n      {\n        \"type\":\"Joint Secretary\",\n        \"profile\":[{\"name\":\"Ankit Jain\",\"email\":\"bhaiji.ankitjain1993@gmail.com\",\"phone\":\"9043807215\"}]\n      },\n      {\n        \"type\":\"Events\",\n        \"profile\":[{\"name\":\"K Akhil\",\"email\":\"akhilkollu96@gmail.com\",\"phone\":\"9176493264\"},\n        {\"name\":\"M V Suhaas\",\"email\":\"suhaasmekala@gmail.com\",\"phone\":\"8220154858\"}]\n      },\n      {\n        \"type\":\"Student Relations\",\n        \"profile\":[{\"name\":\"Naveen Kanna M\",\"email\":\"naveenkanna28@gmail.com\",\"phone\":\"8903940256\"},\n        {\"name\":\"T Sumanth Kalyan\",\"email\":\"sumanth.kalyan79@gmail.com\",\"phone\":\"9790465204\"}]\n      },\n      {\n        \"type\":\"Sponsorship & Public Relations\",\n        \"profile\":[{\"name\":\"Hitesh Malla\",\"email\":\"hitesh.m95@gmail.com\",\"phone\":\"9087863969\"},\n        {\"name\":\"Kartheek K\",\"email\":\"kartheek301096@gmail.com\",\"phone\":\"9677077500\"}]\n      },\n      {\n        \"type\":\"Web & Mobile Operations\",\n        \"profile\":[{\"name\":\"K Venkat Teja\",\"email\":\"teja.kunisetty@gmail.com\",\"phone\":\"7200317939\"}]\n      },\n      {\n        \"type\":\"Design & Media\",\n        \"profile\":[{\"name\":\"M Ravi Theja\",\"email\":\"ravithejamavuri@gmail.com \",\"phone\":\"9790464008\"}]\n      },\n      {\n        \"type\":\"Finance\",\n        \"profile\":[{\"name\":\"B Bhanu Mitra\",\"email\":\"bhanumitrab@gmail.com\",\"phone\":\"9087863231\"},\n        {\"name\":\"S Maneesha Devi\",\"email\":\"rajsridevi598@gmail.com\",\"phone\":\"9790469606\"}]\n      },\n      {\n        \"type\":\"Facilities & Requirements\",\n        \"profile\":[{\"name\":\"Cesh J\",\"email\":\"ceshcool@gmail.com\",\"phone\":\"9940451199\"}]\n      },\n      {\n        \"type\":\"QMS\",\n        \"profile\":[{\"name\":\"S Bharath\",\"email\":\"rocky.bharath1997@gmail.com\",\"phone\":\"9791336202\"}]\n      }\n\n    ];\n\n    return res.json(contacts);\n}\nexport function spons(req, res){\n  var spons = [\n                {title:\"Title Sponsor\"},\n                {title:\"Merchandise Partner\"},\n                {title:\"Design Partner\"},\n                {title:\"Events Partner\"},\n                {title:\"Education Partner\", num: [1,2,3]},\n                {title:\"Knowledge Partner\"},\n                {title:\"Professional Training Partner\"},\n                {title:\"Workshop Partner\"},\n                {title:\"Travel Partner\"},\n                {title:\"Student Opportunity Partner\"},\n                {title:\"Entertainment Partner\"},\n                {title:\"Ticketing Partner\"},\n                {title:\"Online Media Partner\", num:[1,2]},\n                {title:\"Finance Partner\"},\n              ];\n  return res.json(spons);\n}\n\n/**\n * Get a single user\n */\nexport function show(req, res, next) {\n  if(!validator.isMongoId(req.params.id+\"\"))\n   return res.status(400).send(\"Invalid Id\");\n\n  var userId = req.params.id;\n\n  return User.findById(userId).exec()\n    .then(user => {\n      if(!user) {\n        return res.status(404).end();\n      }\n      res.json(user.profileDetails);\n    })\n    .catch(err => next(err));\n}\n\n/**\n * Deletes a user\n * restriction: \"admin\"\n */\nexport function destroy(req, res) {\n  if(!validator.isMongoId(req.params.id+\"\"))\n    return res.status(400).send(\"Invalid Id\");\n\n  return User.findByIdAndRemove(req.params.id).exec()\n    .then(function() {\n      res.status(204).end();\n    })\n    .catch(handleError(res));\n}\n\n/**\n * Change a users password\n */\nexport function changePassword(req, res) {\n  if(!validator.isMongoId(req.user._id+\"\"))\n    return res.status(400).send(\"Invalid Id\");\n\n  var userId = req.user._id;\n  var oldPass = String(req.body.oldPassword);\n  var newPass = String(req.body.newPassword);\n\n  return User.findById(userId).exec()\n    .then(user => {\n      if(user.authenticate(oldPass)) {\n        user.password = newPass;\n        return user.save()\n          .then(() => {\n            res.status(204).end();\n          })\n          .catch(validationError(res));\n      } else {\n        return res.status(403).end();\n      }\n    });\n}\n\n/**\n * Get my info\n */\nexport function me(req, res, next) {\n  if(!validator.isMongoId(req.user._id+\"\"))\n    return res.status(400).send(\"Invalid Id\");\n  var userId = req.user._id;\n\n  return User.findOne({ _id: userId }, \"-salt -password\").populate(\"house\").exec()\n    .then(user => { // don\"t ever give out the password or salt\n      if(!user) {\n        return res.status(401).end();\n      }\n      res.json(user);\n    })\n    .catch(err => next(err));\n}\n/**\n * Authentication callback\n */\nexport function authCallback(req, res) {\n  res.redirect(\"/\");\n}\n"],"sourceRoot":"/source/"}